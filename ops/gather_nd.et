params[batch,elem,other] = RANDOM(0, 10, FLOAT)
indices[batch,slice,coord] = RANDOM(0, DIMS(elem)[coord], INT)
result[batch,slice,other] = params[batch,indices[batch,slice,:],other]

tf.gather_nd(params, indices, batch_dims=RANK(batch))

result

RANK(batch,slice,other) < 8
RANK(batch,elem,other) < 8
RANK(coord) = 1
DIMS(coord) = RANK(elem)
RANK(elem) IN [1,8]
DIMS(batch) IN [0,4]
DIMS(slice) IN [0,20]
DIMS(elem) IN [1,20]
DIMS(other) IN [1,20]


