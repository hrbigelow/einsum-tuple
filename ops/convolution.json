{
  "program": [
    "input[batch,ipos,ichan] = RANDOM()",
    "filters[fpos,ichan,ochan] = RANDOM()",
    "output[batch,ipos-fpos,ochan] = input[batch,ipos,ichan] * filters[fpos,ichan,ochan]"
  ],
  "constraints": [
    "RANK(ipos) >= 1",
    "RANK(ipos) <= 3",
    "RANK(ipos) == RANK(fpos)",
    "DIMS(fpos) <= DIMS(ipos)",
    "RANK(batch) == 1",
    "RANK(ichan) == 1",
    "RANK(ochan) == RANK(ichan)",
    "MIN(ipos-fpos) := 0",
    "MAX(ipos-fpos) := DIMS(ipos) - DIMS(fpos)"
  ],
  "tfcall": {
    "func": "tf.nn.convolution",
    "args": {
      "input": "input",
      "filters": "filters"
    },
    "const-args": {
      "padding": "VALID"
    },
    "return-value": "output"
  }
}

