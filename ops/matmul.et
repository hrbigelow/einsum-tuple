mat1[batch,row,inner] = RANDOM(0, 10, FLOAT)
mat2[batch,inner,col] = RANDOM(0, 10, FLOAT)
result[batch,row,col] = mat1[batch,row,inner] * mat2[batch,inner,col]

tf.linalg.matmul(mat1, mat2)

result

RANK(row) == RANK(col) == RANK(inner) == 1
RANK(batch) < 4
DIMS(batch) < 4
DIMS(row) < 50
DIMS(inner) < 100
DIMS(col) < 50

